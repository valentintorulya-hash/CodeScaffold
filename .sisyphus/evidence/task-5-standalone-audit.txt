Task 5 - Standalone Build/Start Audit (scripts)
Scope: Static audit only (no build/start execution)

Reference files:
- scripts/postbuild-copy.mjs
- scripts/start-standalone.mjs
- next.config.ts

1) Standalone mode is enabled
- next.config.ts sets `output: "standalone"`.
- This tells Next.js build output to produce a standalone server layout under `.next/standalone`.

2) What `scripts/postbuild-copy.mjs` copies and why
- It resolves the standalone server entry path with `resolveStandaloneServerPath()`:
  - First choice: `.next/standalone/server.js`.
  - Fallback metadata: `.next/required-server-files.json` -> `relativeAppDir` -> `.next/standalone/<relativeAppDir>/server.js`.
- It exits with code 1 if standalone `server.js` cannot be found.
- After resolving the app dir, it copies runtime assets:
  - `.next/static` -> `<standaloneAppDir>/.next/static`
  - `public` -> `<standaloneAppDir>/public`
- Why: standalone server needs static/public assets colocated with the standalone app directory so `server.js` can serve static files and public assets correctly.

3) How `scripts/start-standalone.mjs` locates and starts the server
- It uses the same path resolution pattern:
  - Try `.next/standalone/server.js`.
  - If not found, parse `.next/required-server-files.json` and use `relativeAppDir` to test nested `.next/standalone/<relativeAppDir>/server.js`.
- If no valid path exists, it prints an actionable error and exits.
- If found, it starts the standalone server using:
  - `spawn(process.execPath, [serverPath], { stdio: "inherit", env: { ...NODE_ENV=production default } })`
- `process.execPath` ensures the same Node runtime running the script is used to launch standalone `server.js`.

4) Expected standalone layout notes
- Build metadata remains in `.next/` including `.next/required-server-files.json`.
- Standalone runtime root expected at `.next/standalone`.
- Entry script expected at either:
  - `.next/standalone/server.js`, or
  - `.next/standalone/<relativeAppDir>/server.js` (based on required-server-files metadata).
- Postbuild copy step expects these runtime assets under the resolved standalone app directory:
  - `.next/static/*`
  - `public/*`

5) Practical Windows caveats (repo-specific)
- Repo orchestration scripts in `.zscripts/*.sh` assume POSIX shell (`sh`/Git Bash/WSL), so standalone verification flow is safer via Bun/Node scripts than shell wrappers on pure Windows CMD.
- Path normalization in both scripts is Windows-aware (`split(/[/\\]+/)`) when deriving nested server path from `relativeAppDir`.
- Caddy binary is currently missing in PATH in this environment, so standalone runtime proxy checks remain blocked; this task is static script audit only.
- `bun start` requires prior successful build artifacts (`.next/standalone` and `.next/required-server-files.json`), otherwise startup script exits by design.
